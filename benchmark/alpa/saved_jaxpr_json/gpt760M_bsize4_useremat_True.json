{
    "eqns": [
        {
            "primitive": "remat_call",
            "invars": [
                "k",
                "a",
                "b"
            ],
            "outvars": [
                "ln"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[51200,1024]\u001b[39m b\u001b[35m:u32[2]\u001b[39m c\u001b[35m:i32[4,1024]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22md\u001b[35m:i32[4,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1)\n      shape=(4, 1024, 1)\n    ] c\n    e\u001b[35m:i32[1,1,51200]\u001b[39m = iota[dimension=2 dtype=int32 shape=(1, 1, 51200)] \n    f\u001b[35m:bool[4,1024,51200]\u001b[39m = eq d e\n    g\u001b[35m:f16[4,1024,51200]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] f\n    h\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] g a\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(h,) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "j",
                "a",
                "c"
            ],
            "outvars": [
                "lo"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[512,1024]\u001b[39m b\u001b[35m:u32[2]\u001b[39m c\u001b[35m:i32[4,1024]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22md\u001b[35m:i32[4,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1)\n      shape=(4, 1024, 1)\n    ] c\n    e\u001b[35m:i32[1,1,512]\u001b[39m = iota[dimension=2 dtype=int32 shape=(1, 1, 512)] \n    f\u001b[35m:bool[4,1024,512]\u001b[39m = eq d e\n    g\u001b[35m:f16[4,1024,512]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] f\n    h\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] g a\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(h,) }"
            }
        },
        {
            "primitive": "add",
            "invars": [
                "ln",
                "lo"
            ],
            "outvars": [
                "lp"
            ],
            "params": {}
        },
        {
            "primitive": "add",
            "invars": [
                "lp",
                "0.0"
            ],
            "outvars": [
                "lq"
            ],
            "params": {}
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "lq"
            ],
            "outvars": [
                "lr"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "reduce_sum",
            "invars": [
                "lr"
            ],
            "outvars": [
                "ls"
            ],
            "params": {
                "axes": [
                    2
                ]
            }
        },
        {
            "primitive": "div",
            "invars": [
                "ls",
                "1024.0"
            ],
            "outvars": [
                "lt"
            ],
            "params": {}
        },
        {
            "primitive": "integer_pow",
            "invars": [
                "lr"
            ],
            "outvars": [
                "lu"
            ],
            "params": {
                "y": 2
            }
        },
        {
            "primitive": "reduce_sum",
            "invars": [
                "lu"
            ],
            "outvars": [
                "lv"
            ],
            "params": {
                "axes": [
                    2
                ]
            }
        },
        {
            "primitive": "div",
            "invars": [
                "lv",
                "1024.0"
            ],
            "outvars": [
                "lw"
            ],
            "params": {}
        },
        {
            "primitive": "integer_pow",
            "invars": [
                "lt"
            ],
            "outvars": [
                "lx"
            ],
            "params": {
                "y": 2
            }
        },
        {
            "primitive": "sub",
            "invars": [
                "lw",
                "lx"
            ],
            "outvars": [
                "ly"
            ],
            "params": {}
        },
        {
            "primitive": "max",
            "invars": [
                "0.0",
                "ly"
            ],
            "outvars": [
                "lz"
            ],
            "params": {}
        },
        {
            "primitive": "reshape",
            "invars": [
                "lt"
            ],
            "outvars": [
                "ma"
            ],
            "params": {
                "new_sizes": [
                    4,
                    1024,
                    1
                ],
                "dimensions": null
            }
        },
        {
            "primitive": "reshape",
            "invars": [
                "lz"
            ],
            "outvars": [
                "mb"
            ],
            "params": {
                "new_sizes": [
                    4,
                    1024,
                    1
                ],
                "dimensions": null
            }
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "lq"
            ],
            "outvars": [
                "mc"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "sub",
            "invars": [
                "mc",
                "ma"
            ],
            "outvars": [
                "md"
            ],
            "params": {}
        },
        {
            "primitive": "add",
            "invars": [
                "mb",
                "9.999999960041972e-13"
            ],
            "outvars": [
                "me"
            ],
            "params": {}
        },
        {
            "primitive": "rsqrt",
            "invars": [
                "me"
            ],
            "outvars": [
                "mf"
            ],
            "params": {}
        },
        {
            "primitive": "reshape",
            "invars": [
                "i"
            ],
            "outvars": [
                "mg"
            ],
            "params": {
                "new_sizes": [
                    1,
                    1,
                    1024
                ],
                "dimensions": null
            }
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "mg"
            ],
            "outvars": [
                "mh"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "mul",
            "invars": [
                "mf",
                "mh"
            ],
            "outvars": [
                "mi"
            ],
            "params": {}
        },
        {
            "primitive": "mul",
            "invars": [
                "md",
                "mi"
            ],
            "outvars": [
                "mj"
            ],
            "params": {}
        },
        {
            "primitive": "reshape",
            "invars": [
                "h"
            ],
            "outvars": [
                "mk"
            ],
            "params": {
                "new_sizes": [
                    1,
                    1,
                    1024
                ],
                "dimensions": null
            }
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "mk"
            ],
            "outvars": [
                "ml"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "add",
            "invars": [
                "mj",
                "ml"
            ],
            "outvars": [
                "mm"
            ],
            "params": {}
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "mm"
            ],
            "outvars": [
                "mn"
            ],
            "params": {
                "new_dtype": "float16",
                "weak_type": false
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "l",
                "m",
                "n",
                "o",
                "p",
                "q",
                "r",
                "s",
                "t",
                "u",
                "v",
                "w",
                "a",
                "mn",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mo",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "x",
                "y",
                "z",
                "ba",
                "bb",
                "bc",
                "bd",
                "be",
                "bf",
                "bg",
                "bh",
                "bi",
                "a",
                "mo",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mp",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "fz",
                "ga",
                "gb",
                "gc",
                "gd",
                "ge",
                "gf",
                "gg",
                "gh",
                "gi",
                "gj",
                "gk",
                "a",
                "mp",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mq",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "ih",
                "ii",
                "ij",
                "ik",
                "il",
                "im",
                "in",
                "io",
                "ip",
                "iq",
                "ir",
                "is",
                "a",
                "mq",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mr",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "it",
                "iu",
                "iv",
                "iw",
                "ix",
                "iy",
                "iz",
                "ja",
                "jb",
                "jc",
                "jd",
                "je",
                "a",
                "mr",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "ms",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "jf",
                "jg",
                "jh",
                "ji",
                "jj",
                "jk",
                "jl",
                "jm",
                "jn",
                "jo",
                "jp",
                "jq",
                "a",
                "ms",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mt",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "jr",
                "js",
                "jt",
                "ju",
                "jv",
                "jw",
                "jx",
                "jy",
                "jz",
                "ka",
                "kb",
                "kc",
                "a",
                "mt",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mu",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "kd",
                "ke",
                "kf",
                "kg",
                "kh",
                "ki",
                "kj",
                "kk",
                "kl",
                "km",
                "kn",
                "ko",
                "a",
                "mu",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mv",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "kp",
                "kq",
                "kr",
                "ks",
                "kt",
                "ku",
                "kv",
                "kw",
                "kx",
                "ky",
                "kz",
                "la",
                "a",
                "mv",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mw",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "lb",
                "lc",
                "ld",
                "le",
                "lf",
                "lg",
                "lh",
                "li",
                "lj",
                "lk",
                "ll",
                "lm",
                "a",
                "mw",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mx",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "bj",
                "bk",
                "bl",
                "bm",
                "bn",
                "bo",
                "bp",
                "bq",
                "br",
                "bs",
                "bt",
                "bu",
                "a",
                "mx",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "my",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "bv",
                "bw",
                "bx",
                "by",
                "bz",
                "ca",
                "cb",
                "cc",
                "cd",
                "ce",
                "cf",
                "cg",
                "a",
                "my",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "mz",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "ch",
                "ci",
                "cj",
                "ck",
                "cl",
                "cm",
                "cn",
                "co",
                "cp",
                "cq",
                "cr",
                "cs",
                "a",
                "mz",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "na",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "ct",
                "cu",
                "cv",
                "cw",
                "cx",
                "cy",
                "cz",
                "da",
                "db",
                "dc",
                "dd",
                "de",
                "a",
                "na",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nb",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "df",
                "dg",
                "dh",
                "di",
                "dj",
                "dk",
                "dl",
                "dm",
                "dn",
                "do",
                "dp",
                "dq",
                "a",
                "nb",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nc",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "dr",
                "ds",
                "dt",
                "du",
                "dv",
                "dw",
                "dx",
                "dy",
                "dz",
                "ea",
                "eb",
                "ec",
                "a",
                "nc",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nd",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "ed",
                "ee",
                "ef",
                "eg",
                "eh",
                "ei",
                "ej",
                "ek",
                "el",
                "em",
                "en",
                "eo",
                "a",
                "nd",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "ne",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "ep",
                "eq",
                "er",
                "es",
                "et",
                "eu",
                "ev",
                "ew",
                "ex",
                "ey",
                "ez",
                "fa",
                "a",
                "ne",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nf",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "fb",
                "fc",
                "fd",
                "fe",
                "ff",
                "fg",
                "fh",
                "fi",
                "fj",
                "fk",
                "fl",
                "fm",
                "a",
                "nf",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "ng",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "fn",
                "fo",
                "fp",
                "fq",
                "fr",
                "fs",
                "ft",
                "fu",
                "fv",
                "fw",
                "fx",
                "fy",
                "a",
                "ng",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nh",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "gl",
                "gm",
                "gn",
                "go",
                "gp",
                "gq",
                "gr",
                "gs",
                "gt",
                "gu",
                "gv",
                "gw",
                "a",
                "nh",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "ni",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "gx",
                "gy",
                "gz",
                "ha",
                "hb",
                "hc",
                "hd",
                "he",
                "hf",
                "hg",
                "hh",
                "hi",
                "a",
                "ni",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nj",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "hj",
                "hk",
                "hl",
                "hm",
                "hn",
                "ho",
                "hp",
                "hq",
                "hr",
                "hs",
                "ht",
                "hu",
                "a",
                "nj",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nk",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "remat_call",
            "invars": [
                "hv",
                "hw",
                "hx",
                "hy",
                "hz",
                "ia",
                "ib",
                "ic",
                "id",
                "ie",
                "if",
                "ig",
                "a",
                "nk",
                "d",
                "True",
                "False"
            ],
            "outvars": [
                "nl",
                "_"
            ],
            "params": {
                "name": "core_fn",
                "concrete": true,
                "prevent_cse": true,
                "differentiated": false,
                "policy": null,
                "call_jaxpr": "{ \u001b[34m\u001b[22m\u001b[1mlambda \u001b[39m\u001b[22m\u001b[22m; a\u001b[35m:f16[1024]\u001b[39m b\u001b[35m:f16[1024]\u001b[39m c\u001b[35m:f16[1024]\u001b[39m d\u001b[35m:f16[1024,1024]\u001b[39m e\u001b[35m:f16[3072]\u001b[39m f\u001b[35m:f16[1024,3072]\u001b[39m\n    g\u001b[35m:f16[4096]\u001b[39m h\u001b[35m:f16[1024,4096]\u001b[39m i\u001b[35m:f16[1024]\u001b[39m j\u001b[35m:f16[1024]\u001b[39m k\u001b[35m:f16[1024]\u001b[39m l\u001b[35m:f16[4096,1024]\u001b[39m\n    m\u001b[35m:u32[2]\u001b[39m n\u001b[35m:f16[4,1024,1024]\u001b[39m o\u001b[35m:i32[4,1024]\u001b[39m p\u001b[35m:bool[]\u001b[39m q\u001b[35m:bool[]\u001b[39m. \u001b[34m\u001b[22m\u001b[1mlet\n    \u001b[39m\u001b[22m\u001b[22mr\u001b[35m:f16[4,1024,3072]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] n f\n    s\u001b[35m:f16[1,1,3072]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 3072)] e\n    t\u001b[35m:f16[4,1024,3072]\u001b[39m = add r s\n    u\u001b[35m:f16[4,1024,1024,3]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024, 3)] t\n    v\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 1)\n      start_indices=(0, 0, 0, 0)\n      strides=None\n    ] u\n    w\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 2)\n      start_indices=(0, 0, 0, 1)\n      strides=None\n    ] u\n    x\u001b[35m:f16[4,1024,1024,1]\u001b[39m = slice[\n      limit_indices=(4, 1024, 1024, 3)\n      start_indices=(0, 0, 0, 2)\n      strides=None\n    ] u\n    y\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] v\n    z\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] w\n    ba\u001b[35m:f16[4,1024,16,64]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 16, 64)] x\n    bb\u001b[35m:i32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 3)\n      shape=(4, 1, 1, 1024)\n    ] o\n    bc\u001b[35m:bool[4,1,1,1024]\u001b[39m = gt bb 0\n    bd\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] 0.0\n    be\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bd\n    bf\u001b[35m:f32[4,1,1,1024]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=()\n      shape=(4, 1, 1, 1024)\n    ] -10000000000.0\n    bg\u001b[35m:f16[4,1,1,1024]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bf\n    bh\u001b[35m:f16[4,1,1,1024]\u001b[39m = select_n bc bg be\n    bi\u001b[35m:f32[]\u001b[39m = sqrt 64.0\n    bj\u001b[35m:f16[]\u001b[39m = convert_element_type[new_dtype=float16 weak_type=False] bi\n    bk\u001b[35m:f16[4,1024,16,64]\u001b[39m = div y bj\n    bl\u001b[35m:f16[4,16,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((3,), (3,)), ((0, 2), (0, 2)))\n      precision=None\n      preferred_element_type=None\n    ] bk ba\n    bm\u001b[35m:f16[4,16,1024,1024]\u001b[39m = add bl bh\n    bn\u001b[35m:f16[4,16,1024]\u001b[39m = reduce_max[axes=(3,)] bm\n    bo\u001b[35m:f16[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bn\n    bp\u001b[35m:f16[4,16,1024,1]\u001b[39m = stop_gradient bo\n    bq\u001b[35m:f16[4,16,1024,1024]\u001b[39m = sub bm bp\n    br\u001b[35m:f16[4,16,1024,1024]\u001b[39m = exp bq\n    bs\u001b[35m:f32[4,16,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] br\n    bt\u001b[35m:f32[4,16,1024]\u001b[39m = reduce_sum[axes=(3,)] bs\n    bu\u001b[35m:f32[4,16,1024,1]\u001b[39m = broadcast_in_dim[\n      broadcast_dimensions=(0, 1, 2)\n      shape=(4, 16, 1024, 1)\n    ] bt\n    bv\u001b[35m:f16[4,16,1024,1]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] bu\n    bw\u001b[35m:f16[4,16,1024,1024]\u001b[39m = div br bv\n    bx\u001b[35m:f16[4,16,64,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((1,), (3,)), ((0, 2), (0, 1)))\n      precision=None\n      preferred_element_type=None\n    ] z bw\n    by\u001b[35m:f16[4,1024,16,64]\u001b[39m = transpose[permutation=(0, 3, 1, 2)] bx\n    bz\u001b[35m:f16[4,1024,1024]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1024)] by\n    ca\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] bz d\n    cb\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] c\n    cc\u001b[35m:f16[4,1024,1024]\u001b[39m = add ca cb\n    cd\u001b[35m:f16[4,1024,1024]\u001b[39m = add cc n\n    ce\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cf\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ce\n    cg\u001b[35m:f32[4,1024]\u001b[39m = div cf 1024.0\n    ch\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] ce\n    ci\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] ch\n    cj\u001b[35m:f32[4,1024]\u001b[39m = div ci 1024.0\n    ck\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] cg\n    cl\u001b[35m:f32[4,1024]\u001b[39m = sub cj ck\n    cm\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 cl\n    cn\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cg\n    co\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] cm\n    cp\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] cd\n    cq\u001b[35m:f32[4,1024,1024]\u001b[39m = sub cp cn\n    cr\u001b[35m:f32[4,1024,1]\u001b[39m = add co 9.999999960041972e-13\n    cs\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt cr\n    ct\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] b\n    cu\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ct\n    cv\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cs cu\n    cw\u001b[35m:f32[4,1024,1024]\u001b[39m = mul cq cv\n    cx\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] a\n    cy\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] cx\n    cz\u001b[35m:f32[4,1024,1024]\u001b[39m = add cw cy\n    da\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] cz\n    db\u001b[35m:f16[4,1024,4096]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] da h\n    dc\u001b[35m:f16[1,1,4096]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 4096)] g\n    dd\u001b[35m:f16[4,1024,4096]\u001b[39m = add db dc\n    de\u001b[35m:f16[4,1024,4096]\u001b[39m = div dd 1.4140625\n    df\u001b[35m:f16[4,1024,4096]\u001b[39m = erf de\n    dg\u001b[35m:f16[4,1024,4096]\u001b[39m = add df 1.0\n    dh\u001b[35m:f16[4,1024,4096]\u001b[39m = mul dd dg\n    di\u001b[35m:f16[4,1024,4096]\u001b[39m = div dh 2.0\n    dj\u001b[35m:f16[4,1024,4096]\u001b[39m = copy di\n    dk\u001b[35m:f16[4,1024,1024]\u001b[39m = dot_general[\n      dimension_numbers=(((2,), (0,)), ((), ()))\n      precision=None\n      preferred_element_type=None\n    ] dj l\n    dl\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] k\n    dm\u001b[35m:f16[4,1024,1024]\u001b[39m = add dk dl\n    dn\u001b[35m:f16[4,1024,1024]\u001b[39m = add dm da\n    do\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    dp\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] do\n    dq\u001b[35m:f32[4,1024]\u001b[39m = div dp 1024.0\n    dr\u001b[35m:f32[4,1024,1024]\u001b[39m = integer_pow[y=2] do\n    ds\u001b[35m:f32[4,1024]\u001b[39m = reduce_sum[axes=(2,)] dr\n    dt\u001b[35m:f32[4,1024]\u001b[39m = div ds 1024.0\n    du\u001b[35m:f32[4,1024]\u001b[39m = integer_pow[y=2] dq\n    dv\u001b[35m:f32[4,1024]\u001b[39m = sub dt du\n    dw\u001b[35m:f32[4,1024]\u001b[39m = max 0.0 dv\n    dx\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dq\n    dy\u001b[35m:f32[4,1024,1]\u001b[39m = reshape[dimensions=None new_sizes=(4, 1024, 1)] dw\n    dz\u001b[35m:f32[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float32\n      weak_type=False\n    ] dn\n    ea\u001b[35m:f32[4,1024,1024]\u001b[39m = sub dz dx\n    eb\u001b[35m:f32[4,1024,1]\u001b[39m = add dy 9.999999960041972e-13\n    ec\u001b[35m:f32[4,1024,1]\u001b[39m = rsqrt eb\n    ed\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] j\n    ee\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] ed\n    ef\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ec ee\n    eg\u001b[35m:f32[4,1024,1024]\u001b[39m = mul ea ef\n    eh\u001b[35m:f16[1,1,1024]\u001b[39m = reshape[dimensions=None new_sizes=(1, 1, 1024)] i\n    ei\u001b[35m:f32[1,1,1024]\u001b[39m = convert_element_type[new_dtype=float32 weak_type=False] eh\n    ej\u001b[35m:f32[4,1024,1024]\u001b[39m = add eg ei\n    ek\u001b[35m:f16[4,1024,1024]\u001b[39m = convert_element_type[\n      new_dtype=float16\n      weak_type=False\n    ] ej\n  \u001b[34m\u001b[22m\u001b[1min \u001b[39m\u001b[22m\u001b[22m(ek, bw) }"
            }
        },
        {
            "primitive": "dot_general",
            "invars": [
                "nl",
                "g"
            ],
            "outvars": [
                "nm"
            ],
            "params": {
                "dimension_numbers": [
                    [
                        [
                            2
                        ],
                        [
                            0
                        ]
                    ],
                    [
                        [],
                        []
                    ]
                ],
                "precision": null,
                "preferred_element_type": null
            }
        },
        {
            "primitive": "broadcast_in_dim",
            "invars": [
                "f"
            ],
            "outvars": [
                "nn"
            ],
            "params": {
                "shape": [
                    1,
                    1,
                    51200
                ],
                "broadcast_dimensions": [
                    2
                ]
            }
        },
        {
            "primitive": "add",
            "invars": [
                "nm",
                "nn"
            ],
            "outvars": [
                "no"
            ],
            "params": {}
        },
        {
            "primitive": "gt",
            "invars": [
                "e",
                "0"
            ],
            "outvars": [
                "np"
            ],
            "params": {}
        },
        {
            "primitive": "broadcast_in_dim",
            "invars": [
                "1.0"
            ],
            "outvars": [
                "nq"
            ],
            "params": {
                "shape": [
                    4,
                    1024
                ],
                "broadcast_dimensions": []
            }
        },
        {
            "primitive": "broadcast_in_dim",
            "invars": [
                "0.0"
            ],
            "outvars": [
                "nr"
            ],
            "params": {
                "shape": [
                    4,
                    1024
                ],
                "broadcast_dimensions": []
            }
        },
        {
            "primitive": "select_n",
            "invars": [
                "np",
                "nr",
                "nq"
            ],
            "outvars": [
                "ns"
            ],
            "params": {}
        },
        {
            "primitive": "broadcast_in_dim",
            "invars": [
                "e"
            ],
            "outvars": [
                "nt"
            ],
            "params": {
                "shape": [
                    4,
                    1024,
                    1
                ],
                "broadcast_dimensions": [
                    0,
                    1
                ]
            }
        },
        {
            "primitive": "iota",
            "invars": [],
            "outvars": [
                "nu"
            ],
            "params": {
                "dtype": "int32",
                "shape": [
                    1,
                    1,
                    51200
                ],
                "dimension": 2
            }
        },
        {
            "primitive": "eq",
            "invars": [
                "nt",
                "nu"
            ],
            "outvars": [
                "nv"
            ],
            "params": {}
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "nv"
            ],
            "outvars": [
                "nw"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "reduce_max",
            "invars": [
                "no"
            ],
            "outvars": [
                "nx"
            ],
            "params": {
                "axes": [
                    2
                ]
            }
        },
        {
            "primitive": "broadcast_in_dim",
            "invars": [
                "nx"
            ],
            "outvars": [
                "ny"
            ],
            "params": {
                "shape": [
                    4,
                    1024,
                    1
                ],
                "broadcast_dimensions": [
                    0,
                    1
                ]
            }
        },
        {
            "primitive": "stop_gradient",
            "invars": [
                "ny"
            ],
            "outvars": [
                "nz"
            ],
            "params": {}
        },
        {
            "primitive": "sub",
            "invars": [
                "no",
                "nz"
            ],
            "outvars": [
                "oa"
            ],
            "params": {}
        },
        {
            "primitive": "exp",
            "invars": [
                "oa"
            ],
            "outvars": [
                "ob"
            ],
            "params": {}
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "ob"
            ],
            "outvars": [
                "oc"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "reduce_sum",
            "invars": [
                "oc"
            ],
            "outvars": [
                "od"
            ],
            "params": {
                "axes": [
                    2
                ]
            }
        },
        {
            "primitive": "broadcast_in_dim",
            "invars": [
                "od"
            ],
            "outvars": [
                "oe"
            ],
            "params": {
                "shape": [
                    4,
                    1024,
                    1
                ],
                "broadcast_dimensions": [
                    0,
                    1
                ]
            }
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "oe"
            ],
            "outvars": [
                "of"
            ],
            "params": {
                "new_dtype": "float16",
                "weak_type": false
            }
        },
        {
            "primitive": "log",
            "invars": [
                "of"
            ],
            "outvars": [
                "og"
            ],
            "params": {}
        },
        {
            "primitive": "sub",
            "invars": [
                "oa",
                "og"
            ],
            "outvars": [
                "oh"
            ],
            "params": {}
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "oh"
            ],
            "outvars": [
                "oi"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "mul",
            "invars": [
                "nw",
                "oi"
            ],
            "outvars": [
                "oj"
            ],
            "params": {}
        },
        {
            "primitive": "reduce_sum",
            "invars": [
                "oj"
            ],
            "outvars": [
                "ok"
            ],
            "params": {
                "axes": [
                    2
                ]
            }
        },
        {
            "primitive": "neg",
            "invars": [
                "ok"
            ],
            "outvars": [
                "ol"
            ],
            "params": {}
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "ns"
            ],
            "outvars": [
                "om"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "mul",
            "invars": [
                "om",
                "ol"
            ],
            "outvars": [
                "on"
            ],
            "params": {}
        },
        {
            "primitive": "reduce_sum",
            "invars": [
                "on"
            ],
            "outvars": [
                "oo"
            ],
            "params": {
                "axes": [
                    0,
                    1
                ]
            }
        },
        {
            "primitive": "convert_element_type",
            "invars": [
                "ns"
            ],
            "outvars": [
                "op"
            ],
            "params": {
                "new_dtype": "float32",
                "weak_type": false
            }
        },
        {
            "primitive": "reduce_sum",
            "invars": [
                "op"
            ],
            "outvars": [
                "oq"
            ],
            "params": {
                "axes": [
                    0,
                    1
                ]
            }
        },
        {
            "primitive": "div",
            "invars": [
                "oo",
                "oq"
            ],
            "outvars": [
                "or"
            ],
            "params": {}
        }
    ],
    "vars": {
        "ln": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 0
        },
        "k": {
            "shape": [
                51200,
                1024
            ],
            "dtype": "float16"
        },
        "a": {
            "shape": [
                2
            ],
            "dtype": "uint32"
        },
        "b": {
            "shape": [
                4,
                1024
            ],
            "dtype": "int32"
        },
        "lo": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 1
        },
        "j": {
            "shape": [
                512,
                1024
            ],
            "dtype": "float16"
        },
        "c": {
            "shape": [
                4,
                1024
            ],
            "dtype": "int32"
        },
        "lp": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 2
        },
        "lq": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 3
        },
        "0.0": {
            "shape": [],
            "dtype": "float16"
        },
        "lr": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 4
        },
        "ls": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 5
        },
        "lt": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 6
        },
        "1024.0": {
            "shape": [],
            "dtype": "float32"
        },
        "lu": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 7
        },
        "lv": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 8
        },
        "lw": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 9
        },
        "lx": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 10
        },
        "ly": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 11
        },
        "lz": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 12
        },
        "ma": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float32",
            "node_id": 13
        },
        "mb": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float32",
            "node_id": 14
        },
        "mc": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 15
        },
        "md": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 16
        },
        "me": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float32",
            "node_id": 17
        },
        "9.999999960041972e-13": {
            "shape": [],
            "dtype": "float32"
        },
        "mf": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float32",
            "node_id": 18
        },
        "mg": {
            "shape": [
                1,
                1,
                1024
            ],
            "dtype": "float16",
            "node_id": 19
        },
        "i": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "mh": {
            "shape": [
                1,
                1,
                1024
            ],
            "dtype": "float32",
            "node_id": 20
        },
        "mi": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 21
        },
        "mj": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 22
        },
        "mk": {
            "shape": [
                1,
                1,
                1024
            ],
            "dtype": "float16",
            "node_id": 23
        },
        "h": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ml": {
            "shape": [
                1,
                1,
                1024
            ],
            "dtype": "float32",
            "node_id": 24
        },
        "mm": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float32",
            "node_id": 25
        },
        "mn": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 26
        },
        "mo": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 27
        },
        "_": {
            "shape": [
                4,
                16,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 50
        },
        "l": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "m": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "n": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "o": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "p": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "q": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "r": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "s": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "t": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "u": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "v": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "w": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "d": {
            "shape": [
                4,
                1024
            ],
            "dtype": "int32"
        },
        "True": {
            "shape": [],
            "dtype": "bool"
        },
        "False": {
            "shape": [],
            "dtype": "bool"
        },
        "mp": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 28
        },
        "x": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "y": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "z": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ba": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "bb": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "bc": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "bd": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "be": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "bf": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bg": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bh": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bi": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mq": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 29
        },
        "fz": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ga": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gb": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gc": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "gd": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ge": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "gf": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "gg": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "gh": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gi": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gj": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gk": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mr": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 30
        },
        "ih": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ii": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ij": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ik": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "il": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "im": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "in": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "io": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "ip": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "iq": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ir": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "is": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "ms": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 31
        },
        "it": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "iu": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "iv": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "iw": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "ix": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "iy": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "iz": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "ja": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "jb": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jc": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jd": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "je": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mt": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 32
        },
        "jf": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jg": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jh": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ji": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "jj": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "jk": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "jl": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "jm": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "jn": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jo": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jp": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jq": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mu": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 33
        },
        "jr": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "js": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "jt": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ju": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "jv": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "jw": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "jx": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "jy": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "jz": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ka": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kb": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kc": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mv": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 34
        },
        "kd": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ke": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kf": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kg": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "kh": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ki": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "kj": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "kk": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "kl": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "km": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kn": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ko": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mw": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 35
        },
        "kp": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kq": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kr": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ks": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "kt": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ku": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "kv": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "kw": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "kx": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ky": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "kz": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "la": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mx": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 36
        },
        "lb": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "lc": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ld": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "le": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "lf": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "lg": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "lh": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "li": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "lj": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "lk": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ll": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "lm": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "my": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 37
        },
        "bj": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bk": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bl": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bm": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "bn": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "bo": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "bp": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "bq": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "br": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bs": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bt": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bu": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "mz": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 38
        },
        "bv": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bw": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "bx": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "by": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "bz": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ca": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "cb": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "cc": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "cd": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ce": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cf": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cg": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "na": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 39
        },
        "ch": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ci": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cj": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ck": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "cl": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "cm": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "cn": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "co": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "cp": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cq": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cr": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cs": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nb": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 40
        },
        "ct": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cu": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cv": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "cw": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "cx": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "cy": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "cz": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "da": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "db": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dc": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dd": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "de": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nc": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 41
        },
        "df": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dg": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dh": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "di": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "dj": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "dk": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "dl": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "dm": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "dn": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "do": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dp": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dq": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nd": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 42
        },
        "dr": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ds": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "dt": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "du": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "dv": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "dw": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "dx": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "dy": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "dz": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ea": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "eb": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ec": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "ne": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 43
        },
        "ed": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ee": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ef": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "eg": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "eh": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ei": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "ej": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "ek": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "el": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "em": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "en": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "eo": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nf": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 44
        },
        "ep": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "eq": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "er": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "es": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "et": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "eu": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "ev": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "ew": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "ex": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ey": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ez": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fa": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "ng": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 45
        },
        "fb": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fc": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fd": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fe": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "ff": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "fg": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "fh": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "fi": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "fj": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fk": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fl": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fm": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nh": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 46
        },
        "fn": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fo": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fp": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fq": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "fr": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "fs": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "ft": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "fu": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "fv": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fw": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fx": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "fy": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "ni": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 47
        },
        "gl": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gm": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gn": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "go": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "gp": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "gq": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "gr": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "gs": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "gt": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gu": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gv": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gw": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nj": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 48
        },
        "gx": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gy": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "gz": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ha": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "hb": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "hc": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "hd": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "he": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "hf": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hg": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hh": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hi": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nk": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 49
        },
        "hj": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hk": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hl": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hm": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "hn": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ho": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "hp": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "hq": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "hr": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hs": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ht": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hu": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nl": {
            "shape": [
                4,
                1024,
                1024
            ],
            "dtype": "float16",
            "node_id": 50
        },
        "hv": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hw": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hx": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "hy": {
            "shape": [
                1024,
                1024
            ],
            "dtype": "float16"
        },
        "hz": {
            "shape": [
                3072
            ],
            "dtype": "float16"
        },
        "ia": {
            "shape": [
                1024,
                3072
            ],
            "dtype": "float16"
        },
        "ib": {
            "shape": [
                4096
            ],
            "dtype": "float16"
        },
        "ic": {
            "shape": [
                1024,
                4096
            ],
            "dtype": "float16"
        },
        "id": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ie": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "if": {
            "shape": [
                1024
            ],
            "dtype": "float16"
        },
        "ig": {
            "shape": [
                4096,
                1024
            ],
            "dtype": "float16"
        },
        "nm": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float16",
            "node_id": 51
        },
        "g": {
            "shape": [
                1024,
                51200
            ],
            "dtype": "float16"
        },
        "nn": {
            "shape": [
                1,
                1,
                51200
            ],
            "dtype": "float16",
            "node_id": 52
        },
        "f": {
            "shape": [
                51200
            ],
            "dtype": "float16"
        },
        "no": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float16",
            "node_id": 53
        },
        "np": {
            "shape": [
                4,
                1024
            ],
            "dtype": "bool",
            "node_id": 54
        },
        "e": {
            "shape": [
                4,
                1024
            ],
            "dtype": "int32"
        },
        "0": {
            "shape": [],
            "dtype": "int32"
        },
        "nq": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 55
        },
        "1.0": {
            "shape": [],
            "dtype": "float32"
        },
        "nr": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 56
        },
        "ns": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 57
        },
        "nt": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "int32",
            "node_id": 58
        },
        "nu": {
            "shape": [
                1,
                1,
                51200
            ],
            "dtype": "int32",
            "node_id": 59
        },
        "nv": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "bool",
            "node_id": 60
        },
        "nw": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float32",
            "node_id": 61
        },
        "nx": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float16",
            "node_id": 62
        },
        "ny": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float16",
            "node_id": 63
        },
        "nz": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float16",
            "node_id": 64
        },
        "oa": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float16",
            "node_id": 65
        },
        "ob": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float16",
            "node_id": 66
        },
        "oc": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float32",
            "node_id": 67
        },
        "od": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 68
        },
        "oe": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float32",
            "node_id": 69
        },
        "of": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float16",
            "node_id": 70
        },
        "og": {
            "shape": [
                4,
                1024,
                1
            ],
            "dtype": "float16",
            "node_id": 71
        },
        "oh": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float16",
            "node_id": 72
        },
        "oi": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float32",
            "node_id": 73
        },
        "oj": {
            "shape": [
                4,
                1024,
                51200
            ],
            "dtype": "float32",
            "node_id": 74
        },
        "ok": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 75
        },
        "ol": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 76
        },
        "om": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 77
        },
        "on": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 78
        },
        "oo": {
            "shape": [],
            "dtype": "float32",
            "node_id": 79
        },
        "op": {
            "shape": [
                4,
                1024
            ],
            "dtype": "float32",
            "node_id": 80
        },
        "oq": {
            "shape": [],
            "dtype": "float32",
            "node_id": 81
        },
        "or": {
            "shape": [],
            "dtype": "float32",
            "node_id": 82
        }
    }
}